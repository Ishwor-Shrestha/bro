#!/bin/sh

_bro () {
  local cur prev

  cur=${COMP_WORDS[COMP_CWORD]}
  prev=${COMP_WORDS[COMP_CWORD-1]}

  projects=$(ls $BRO_STATION/projects)

  if (( $COMP_CWORD <= 1 )); then
    COMPREPLY=( $(compgen -W 'create delete list $projects' -- $cur) )
    return 0
  fi

  if [[ "$prev" == "create" ]]; then
    COMPREPLY=( $(compgen -W '-r -p -t' -- $cur) )
    return 0
  fi

  if [[ "$prev" == "delete" ]]; then
    COMPREPLY=( $(compgen -W '$projects' -- $cur) )
    return 0
  fi
}

complete -F _bro bro